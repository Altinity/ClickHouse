name: ReleaseBranchCI

env:
  # Force the stdout and stderr streams to be unbuffered
  PYTHONUNBUFFERED: 1
  AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
  AWS_DEFAULT_REGION: ${{ secrets.AWS_DEFAULT_REGION }}
  AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
  REGRESSION_RESULTS_URL: altinity-build-artifacts/${{github.event.number}}/$GITHUB_SHA


on: # yamllint disable-line rule:truthy
  pull_request:
    types:
      - synchronize
      - reopened
      - opened
    branches:
      # Anything/23.3 (e.g customizations/23.3)
      - '**/23.3*'
  release:
    types:
      - published
      - prereleased
  push:
    branches:
      - 'releases/23.3**'

jobs:
  app:
    runs-on: [self-hosted, style-checker, on-demand, type-cpx41, image-x86-app-docker-ce]
    steps:
      - name: ${{github.event.number}}
        run: echo ${{github.event.number}}
      - name: Set envs
        run: |
          cat >> "$GITHUB_ENV" << 'EOF'
          PR=${{github.event.number}}
          EOF
      - name: env
        run: echo $PR
      
